export const dummyTrips = [
  {
    id: 1,
    userId: 'user1',
    userName: 'Tiziano',
    userColor: 'rgba(0, 123, 255, 1)',
    tripName: 'Tour Asiático 2024',
    coverImage: 'https://images.unsplash.com/photo-1540959733332-eab4deabeeaf?w=800',
    stops: [
      {
        country: 'Spain',
        city: 'Barcelona',
        lat: 41.3874,
        lng: 2.1686
      },
      {
        country: 'Japan',
        city: 'Tokyo',
        lat: 35.6762,
        lng: 139.6503
      },
      {
        country: 'Thailand',
        city: 'Bangkok',
        lat: 13.7563,
        lng: 100.5018
      }
    ],
    startDate: '2024-03-15',
    endDate: '2024-04-05',
    description: 'Experiencia increíble recorriendo Japón y Tailandia. Templos antiguos, tecnología de punta y gastronomía excepcional.'
  },
  {
    id: 2,
    userId: 'user2',
    userName: 'Mireia',
    userColor: 'rgba(40, 167, 69, 1)',
    tripName: 'Ruta Americana',
    coverImage: 'https://images.unsplash.com/photo-1485871981521-5b1fd3805eee?w=800',
    stops: [
      {
        country: 'Spain',
        city: 'Barcelona',
        lat: 41.3874,
        lng: 2.1686
      },
      {
        country: 'USA',
        city: 'New York',
        lat: 40.7128,
        lng: -74.0060
      },
      {
        country: 'Brazil',
        city: 'Rio de Janeiro',
        lat: -22.9068,
        lng: -43.1729
      },
      {
        country: 'Argentina',
        city: 'Buenos Aires',
        lat: -34.6037,
        lng: -58.3816
      }
    ],
    startDate: '2024-05-10',
    endDate: '2024-05-30',
    description: 'Aventura por el continente americano. Desde los rascacielos de Nueva York hasta las playas de Río y el tango en Buenos Aires.'
  },
  {
    id: 3,
    userId: 'user3',
    userName: 'Aleix',
    userColor: 'rgba(255, 152, 0, 1)',
    tripName: 'Eurotrip 2024',
    coverImage: 'https://images.unsplash.com/photo-1502602898657-3e91760cbb34?w=800',
    stops: [
      {
        country: 'Spain',
        city: 'Barcelona',
        lat: 41.3874,
        lng: 2.1686
      },
      {
        country: 'France',
        city: 'Paris',
        lat: 48.8566,
        lng: 2.3522
      },
      {
        country: 'Germany',
        city: 'Berlin',
        lat: 52.5200,
        lng: 13.4050
      },
      {
        country: 'Italy',
        city: 'Rome',
        lat: 41.9028,
        lng: 12.4964
      }
    ],
    startDate: '2024-06-01',
    endDate: '2024-06-25',
    description: 'Ruta europea clásica visitando las capitales más icónicas. Arte, historia, arquitectura y la mejor gastronomía del continente.'
  },
  {
    id: 4,
    userId: 'user1',
    userName: 'Tiziano',
    userColor: 'rgba(0, 123, 255, 1)',
    tripName: 'Robo al Louvre',
    coverImage: 'https://a57.foxnews.com/static.foxnews.com/foxnews.com/content/uploads/2025/10/1200/675/louvre-heist-paris-001.jpg?ve=1&tl=1',
    stops: [
      {
        country: 'Spain',
        city: 'Barcelona',
        lat: 41.3874,
        lng: 2.1686
      },
      {
        country: 'France',
        city: 'Paris',
        lat: 48.8566,
        lng: 2.3522
      }
    ],
    startDate: '2024-09-15',
    endDate: '2024-09-18',
    description: 'Escapadita de fin de semana. Agarré unas joyitas y me volví a casa.'
  },
  {
    id: 5,
    userId: 'user2',
    userName: 'Mireia',
    userColor: 'rgba(40, 167, 69, 1)',
    tripName: 'Marruecos Mágico',
    coverImage: 'https://images.unsplash.com/photo-1489749798305-4fea3ae63d43?w=800',
    stops: [
      {
        country: 'Spain',
        city: 'Barcelona',
        lat: 41.3874,
        lng: 2.1686
      },
      {
        country: 'Morocco',
        city: 'Marrakech',
        lat: 31.6295,
        lng: -7.9811
      }
    ],
    startDate: '2024-08-05',
    endDate: '2024-08-12',
    description: 'Inmersión en la cultura marroquí. Zocos coloridos, desierto del Sahara y hospitalidad única.'
  },
  {
    id: 6,
    userId: 'user3',
    userName: 'Aleix',
    userColor: 'rgba(255, 152, 0, 1)',
    tripName: 'Islandia Salvaje',
    coverImage: 'https://images.unsplash.com/photo-1504893524553-b855bce32c67?w=800',
    stops: [
      {
        country: 'Spain',
        city: 'Barcelona',
        lat: 41.3874,
        lng: 2.1686
      },
      {
        country: 'Iceland',
        city: 'Reykjavik',
        lat: 64.1466,
        lng: -21.9426
      }
    ],
    startDate: '2024-09-01',
    endDate: '2024-09-08',
    description: 'Aventura en la tierra de hielo y fuego. Auroras boreales, glaciares, géiseres y aguas termales.'
  },
  {
    id: 7,
    userId: 'user1',
    userName: 'Tiziano',
    userColor: 'rgba(0, 123, 255, 1)',
    tripName: 'Canguros en Australia',
    coverImage: 'https://images.unsplash.com/photo-1506973035872-a4ec16b8e8d9?w=800',
    stops: [
      {
        country: 'Spain',
        city: 'Barcelona',
        lat: 41.3874,
        lng: 2.1686
      },
      {
        country: 'Australia',
        city: 'Sydney',
        lat: -33.8688,
        lng: 151.2093
      }
    ],
    startDate: '2024-07-10',
    endDate: '2024-07-25',
    description: 'Hemisferio sur, playas paradisíacas, surf y la increíble Opera House de Sydney.'
  },
  {
    id: 8,
    userId: 'user2',
    userName: 'Mireia',
    userColor: 'rgba(40, 167, 69, 1)',
    tripName: 'New York Navideño',
    coverImage: 'https://images.unsplash.com/photo-1605468163519-235c24d18b87?w=800',
    stops: [
      {
        country: 'Spain',
        city: 'Barcelona',
        lat: 41.3874,
        lng: 2.1686
      },
      {
        country: 'USA',
        city: 'New York',
        lat: 40.7128,
        lng: -74.0060
      }
    ],
    startDate: '2024-12-20',
    endDate: '2024-12-28',
    description: 'La magia de Nueva York en Navidad. Times Square, Rockefeller Center y nieve en Central Park.'
  },
  {
    id: 9,
    userId: 'user3',
    userName: 'Aleix',
    userColor: 'rgba(255, 152, 0, 1)',
    tripName: 'Costa Este USA',
    coverImage: 'https://images.unsplash.com/photo-1569098644584-210bcd375b59?w=800',
    stops: [
      {
        country: 'Spain',
        city: 'Barcelona',
        lat: 41.3874,
        lng: 2.1686
      },
      {
        country: 'USA',
        city: 'New York',
        lat: 40.7128,
        lng: -74.0060
      }
    ],
    startDate: '2024-11-10',
    endDate: '2024-11-20',
    description: 'Explorando la vibrante costa este americana. Arte, música y la mejor pizza del mundo.'
  }
]

export function convertTripsToArcs(trips) {
  const arcs = []
  
  trips.forEach(trip => {
    for (let i = 0; i < trip.stops.length - 1; i++) {
      arcs.push({
        tripId: trip.id,
        userId: trip.userId,
        userName: trip.userName,
        userColor: trip.userColor,
        tripName: trip.tripName,
        origin: trip.stops[i],
        destination: trip.stops[i + 1],
        arcIndex: i
      })
    }
  })
  
  return arcs
}

export function processDestinationsFromTrips(trips) {
  const destinationMap = new Map()
  
  trips.forEach(trip => {
    trip.stops.forEach((stop, index) => {
      if (index === 0) return
      
      const cityKey = stop.city
      if (!destinationMap.has(cityKey)) {
        destinationMap.set(cityKey, {
          lat: stop.lat,
          lng: stop.lng,
          name: stop.city,
          country: stop.country,
          trips: []
        })
      }
      
      const cityData = destinationMap.get(cityKey)
      const existingTrip = cityData.trips.find(t => t.tripId === trip.id)
      if (!existingTrip) {
        cityData.trips.push({
        tripId: trip.id,
        userId: trip.userId,
        userName: trip.userName,
        userColor: trip.userColor,
        tripName: trip.tripName,
        userAvatar: trip.userAvatar || null    
      })

      }
    })
  })
  
  return Array.from(destinationMap.values()).map(dest => {
    const uniqueUsers = new Map()
    dest.trips.forEach(trip => {
      if (!uniqueUsers.has(trip.userId)) {
        uniqueUsers.set(trip.userId, {
        userId: trip.userId,
        userName: trip.userName,
        userColor: trip.userColor,
        userAvatar: trip.userAvatar || '/default-avatar.png'
      })
      }
    })
    
    const visitors = Array.from(uniqueUsers.values())
    const pinColor = visitors.length === 1 
      ? visitors[0].userColor 
      : 'rgba(192, 192, 192, 1)'
    
    return {
      ...dest,
      visitors,
      visitCount: dest.trips.length,
      pinColor
    }
  })
}
